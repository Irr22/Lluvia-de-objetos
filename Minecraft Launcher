import minecraft_launcher_lib, subprocess, os

user_window = os.environ['USERNAME']
minecraft_direction = f"C:/Users/{user_window}/AppData/Roaming/.minecraftLauncher"

# Ver todas las versiones que tengo instaladas y mostrarla en un desplegable
versiones_instaladas = minecraft_launcher_lib.utils.get_installed_versions(minecraft_direction)

versiones_instaladas_lista = []
for version_instalada in versiones_instaladas:
    versiones_instaladas_lista.append(version_instalada['id'])
    print(version_instalada['id'])

def instalar_minecraft():
    minecraft_version_instalar = input("Porfavor intoduzca la version: ")

    # Instalar minecraft
    minecraft_launcher_lib.install.install_minecraft_version(minecraft_version_instalar, minecraft_direction)
    print(version_instalada['id'])

def instalar_forge():
    # Instalar forge
    minecraft_version_instalar = input("Porfavor intoduzca la version: ")
    forge = minecraft_launcher_lib.forge.find_forge_version(minecraft_version_instalar)
    minecraft_launcher_lib.forge.install_forge_version(forge,minecraft_direction)
    print("Forge instalado")

def ejecutar_minecraft():
    for version_instalada in versiones_instaladas:
        print(version_instalada['id'])

    minecraft_user = input("Porfavor intoduzca el nombre: ")
    minecraft_version = input("Porfavor intoduzca la version: ")

    options = {
        'username': minecraft_user, # Nombre del usuario
        'uuid': '',
        'token': '',

        'jvmArguments': ["-Xmx4G","-Xmx4G"], # Ram que consumira el minecraft ahora esta puesta en 4
        'launcherVersion': "0.0.2"
    }

    minecraft_command = minecraft_launcher_lib.command.get_minecraft_command(minecraft_version,minecraft_direction,options)

    subprocess.run(minecraft_command)


def menu():
    print("Bienvenido al launcher")
    respuesta = int(input(" Para instalar minecraft (0)\n Para ejecutar minecraft (1)\n Para instalar forge (2)\n"))
    
    match respuesta:
        case 2:
            instalar_forge()
        case 1:
            ejecutar_minecraft()
        case 0:
            instalar_minecraft()
        
menu()
